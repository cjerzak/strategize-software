% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/CS_PlotBestResponse.R
\name{plot_best_response_curves}
\alias{plot_best_response_curves}
\title{Plot Dimension-by-Dimension Best-Response Curves from Adversarial \code{strategize()} Output}
\usage{
plot_best_response_curves(
  res,
  d_ = 1,
  nPoints_br = 100L,
  nPoints_heat = 50L,
  title = NULL,
  col_ast = "blue",
  col_dag = "red",
  lwd_ast = 2,
  lwd_dag = 2,
  point_pch = 19,
  silent = FALSE
)
}
\arguments{
\item{res}{A list returned by \code{\link{strategize}}, which must include
adversarial references. Internally, \code{res} should contain items like
\code{res$a_i_ast}, \code{res$a_i_dag}, the JAX-based functions
(\code{dQ_da_ast}, \code{dQ_da_dag}, \code{QFXN}, \ldots), along with the
appropriate unconstrained parameter vectors.}

\item{d_}{(Integer) The dimension of \eqn{\pi_{\mathrm{ast}}, \pi_{\mathrm{dag}}} to examine.
For example, if you have multiple factors (dimensions), each is indexed by a positive integer.
Defaults to 1.}

\item{nPoints_br}{(Integer) Number of equally spaced grid points in \eqn{[0,1]}
to sample for \emph{the outer} loop. The code does an internal small search
for best responses at each grid point. Larger \code{nPoints_br} => smoother curves
but more computation. Defaults to \code{100L}.}

\item{nPoints_heat}{(Integer) Number of grid points for heat map calculations.
Defaults to \code{50L}.}

\item{title}{(Character or \code{NULL}) Main plot title. If \code{NULL},
an auto-generated title is used, e.g. "Best-Response Curves (Dimension d_=1)".}

\item{col_ast, col_dag}{(Character) Colors for ast’s and dag’s best-response curves,
respectively. Defaults to \code{"blue"} (ast) and \code{"red"} (dag).}

\item{lwd_ast, lwd_dag}{(Numeric) Line widths for ast and dag curves, respectively.
Default is 2.}

\item{point_pch}{(Numeric) Symbol for marking the approximate intersection
(if found) on the plot. Defaults to 19 (filled circle).}

\item{silent}{(Logical) If \code{TRUE}, suppresses printed messages during
the search for intersection. Defaults to \code{FALSE}.}
}
\value{
(Invisibly) A list containing:
\describe{
\item{\code{grid_points}}{A numeric vector of the \code{nPoints_br} grid
values in \eqn{[0,1]} used for the outer loop.}
\item{\code{br_dag_given_ast}}{A numeric vector of the same length, giving
the dag best-response \eqn{\pi_{\mathrm{dag}, d}} at each grid point
for \eqn{\pi_{\mathrm{ast}, d}}.}
\item{\code{br_ast_given_dag}}{A numeric vector with the ast best-response
for each grid point \eqn{\pi_{\mathrm{dag}, d}}.}
}
}
\description{
\code{plot_best_response_curves} takes the result of an adversarial
\code{\link{strategize}} run (i.e., with \code{adversarial = TRUE}) and produces
dimension-specific best-response curves. Specifically, for a chosen factor dimension
\eqn{d}, it plots:
\enumerate{
\item The curve of \eqn{\pi_{\mathrm{dag}, d}^{*}} as a function of
\eqn{\pi_{\mathrm{ast}, d}}.
\item The curve of \eqn{\pi_{\mathrm{ast}, d}^{*}} as a function of
\eqn{\pi_{\mathrm{dag}, d}}.
}
Potential intersection points in this 2D space can indicate approximate equilibria
for dimension \eqn{d}, holding the other dimensions fixed at the solution found by
\code{strategize}.

This function is computationally intensive: for each of \code{nPoints_br} grid values
of \eqn{\pi_{\mathrm{ast}, d}}, it searches over possible \eqn{\pi_{\mathrm{dag}, d}}
(and vice versa) to find each side's best response, re-running partial objective evaluations.
Nonetheless, it provides a direct visualization of how each player (ast or dag) responds
to changes in the other's distribution along a single factor dimension.
}
\details{
\strong{Mechanics:}
For each \eqn{\pi_{\mathrm{ast}, d} \in \{0,\frac{1}{nPoints_br-1},\ldots,1\}},
the function temporarily fixes that dimension in the ast player’s unconstrained
parameter vector. It then does an internal grid search over \eqn{\pi_{\mathrm{dag}, d}}
to see which value yields the largest dag payoff (lowest ast payoff), consistent
with \code{adversarial=TRUE}. The resulting curve is \eqn{\mathrm{BR}_{\mathrm{dag}}(\pi_{\mathrm{ast},d})}.

Likewise, it holds \eqn{\pi_{\mathrm{dag}, d}} fixed and searches over
\eqn{\pi_{\mathrm{ast}, d}} to get \eqn{\mathrm{BR}_{\mathrm{ast}}(\pi_{\mathrm{dag},d})}.

The intersection in \eqn{\bigl(\pi_{\mathrm{ast}, d}, \pi_{\mathrm{dag}, d}\bigr)}-space
(if one exists in the discretized grid) is a candidate local equilibrium for that factor
dimension, \emph{given that the other factor dimensions remain at the solution from
\code{\link{strategize}}.}

\strong{Performance Caution:} This brute force line-search re-runs partial
objective evaluations many times, which may be slow for large \code{nPoints_br} or
complex outcome models. Consider using a smaller \code{nPoints_br} if performance
is an issue, or focusing on only a handful of crucial dimensions \eqn{d}.
}
\examples{
\dontrun{
# =====================================================
# Visualize best-response curves in adversarial mode
# =====================================================
# First, fit an adversarial strategize model
set.seed(42)
n <- 400

# Generate data with party structure
W <- data.frame(
  Gender = sample(c("Male", "Female"), n, replace = TRUE),
  Age = sample(c("Young", "Middle", "Old"), n, replace = TRUE)
)

# Party affiliations for respondents and candidates
respondent_party <- sample(c("Dem", "Rep"), n/2, replace = TRUE)
candidate_party <- rep(c("Dem", "Rep"), n/2)

Y <- rbinom(n, 1, 0.5)  # Simplified outcome

# Fit adversarial model
adv_result <- strategize(
  Y = Y,
  W = W,
  lambda = 0.1,
  adversarial = TRUE,
  competing_group_variable_respondent = rep(respondent_party, each = 2),
  competing_group_variable_candidate = candidate_party,
  nSGD = 100
)

# Plot best-response curves for Gender dimension (d_ = 1)
# Shows how each party's optimal Gender distribution responds
# to changes in the other party's Gender distribution
plot_best_response_curves(
  res = adv_result,
  d_ = 1,  # Gender is first factor
  nPoints_br = 50,
  title = "Gender: Best-Response Curves",
  col_ast = "blue",   # Democrats
  col_dag = "red"     # Republicans
)

# Intersection point indicates Nash equilibrium for this dimension
}

}
\seealso{
\code{\link{strategize}} for obtaining the result object \code{res} in adversarial mode.
See also \code{\link{cv_strategize}}, and if one-step M-estimation is desired,
see \code{\link{strategize_onestep}}.
}
